<html>
	<head>
		<title>testing i18n extra locales</title>
		<!-- gotta do this in a separate page since clearing all the caches in the loader and dojo/i18n is too error-prone -->

		<script type="text/javascript">
			var dohArgs= (window.parent.doh && window.parent.doh.dohArgs) || {async:1};
			var dojoConfig = {
				async:1,
				extraLocale:['en-us-hawaii', 'en-us-new_york-brooklyn']
			};
		</script>

		<script type="text/javascript" src="../dojo.js" data-dojo-config=""></script>

		<script type="text/javascript">
		// the following should load the current locale + 'en-us-hawaii' and 'en-us-new_york-brooklyn
		require(["dojo", "doh", "dojo/i18n!dojo/tests/nls/salutations"], function(dojo, doh){
			if(dohArgs.async){
				doh.register(function extraLocalesAsync(t){
					t.is(require("dojo/i18n!dojo/tests/nls/en-us-hawaii/salutations").hello, "Aloha");
					t.is(require("dojo/i18n!dojo/tests/nls/en-us-new_york-brooklyn/salutations").hello, "Yo");
					try{
						var result = require("dojo/i18n!/dojo/tests/nls/ar/salutations");
						t.f(true, "should have thrown");
					}catch(e){
						t.t(/has not been requested/.test(e));
					}
				});
			}else{
				doh.register(function extraLocalesSync(t){
					t.is(dojo.i18n.getLocalization("dojo/tests", "salutations", "en-us-hawaii").hello, "Aloha");
					t.is(dojo.i18n.getLocalization("dojo/tests", "salutations", "en-us-new_york-brooklyn").hello, "Yo");
					try{
						var result = require("dojo/i18n!/dojo/tests/nls/ar/salutations");
						t.f(true, "should have thrown");
					}catch(e){
						t.t(/has not been requested/.test(e));
					}
				});
			}
			doh.runOnLoad();
		});
		</script>
	</head>
	<body>
	</body>
</html>

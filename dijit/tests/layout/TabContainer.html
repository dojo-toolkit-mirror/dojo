<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>TabContainer Test</title>

	<style>
		@import "../../../dojo/resources/dojo.css";
		@import "../css/dijitTests.css";

		.box {
		  position: relative;
			background-color: white;
			border: 2px solid black;
			padding: 8px;
			margin: 4px;
		}
	</style>

	<!-- required: the default dijit theme: -->
	<link id="themeStyles" rel="stylesheet" href="../../../dijit/themes/tundra/tundra.css">

	<!-- required: dojo.js -->
	<script type="text/javascript" src="../../../dojo/dojo.js"
		djConfig="isDebug: true, parseOnLoad: true"></script>

	<!-- only needed for alternate theme testing: do NOT use in your code! -->
	<script type="text/javascript" src="../_testCommon.js"></script>


	<script type="text/javascript">
		dojo.require('doh.runner');
		dojo.require("dijit.dijit"); // optimize: load dijit layer
		dojo.require("dijit.layout.TabContainer");
		dojo.require("dijit.layout.ContentPane");
		dojo.require("dojo.parser");	// scan page for widgets and instantiate them

		// create a do nothing, only for test widget
		dojo.addOnLoad(function(){

			doh.register("creationAndDestruction", [
			{
				name: 'destroyMenu',
				runTest: function(t){
					var numWidgets = dijit.registry.length;
					var tc = new dijit.layout.TabContainer({ id:"creationAndDestruction", useMenu:true }).placeAt(dojo.body());
					tc.destroyRecursive();

					t.assertEqual(dijit.registry.length, numWidgets);
				}
			},
			{
				name: 'createWidgetsWithMenu',
				runTest: function(t){

					var numMenus = dijit.registry.byClass("dijit.Menu").length;
					var tc = new dijit.layout.TabContainer({ id:"createWidgetsWithMenu", useMenu:true }).placeAt(dojo.body());
					
					var numCreatedMenus = dijit.registry.byClass("dijit.Menu").length;

					tc.destroyRecursive();

					t.assertEqual(numMenus + 1, numCreatedMenus);
				}
			},
			{
				name: 'createWidgetsWithoutMenu',
				runTest: function(t){

					var numMenus = dijit.registry.byClass("dijit.Menu").length;
					var tc = new dijit.layout.TabContainer({ id:"createWidgetsWithoutMenu", useMenu:false }).placeAt(dojo.body());
					
					var numCreatedMenus = dijit.registry.byClass("dijit.Menu").length;
					tc.destroyRecursive();

					t.assertEqual(numMenus, numCreatedMenus);
				}
			},
			{
				name: 'checkTabLabels',
				runTest: function(t){
					var tabLabels = dojo.query("#tc1 .tabLabel");
					t.assertEqual(3, tabLabels.length);
				}
			}
			]);
			
			doh.register( "addingTabs", [
				{
					name: 'addPaneTab',
					runTest: function(t){
						var tc = dijit.byId("tc1");
						var cp1 = new dijit.layout.ContentPane({
						         title: "newTab1",
						         content: "tab 1 content"
						    });
						    tc.addChild(cp1);
						
							var tabLabels = dojo.query("#tc1 .tabLabel");
							t.assertEqual(4, tabLabels.length);
					}
				},
				{
					name: 'addTab',
					runTest: function(t){
						var tc = dijit.byId("tc1");
						var childPanes = tc.getChildren();
						t.assertEqual(4, childPanes.length);
					}
				},
				{
					name: 'addTabsOverflowMenu',
					runTest: function(t){
						var tc = dijit.byId("tc1");
						
						var cp2 = new dijit.layout.ContentPane({
						         title: "newTab2",
						         content: "tab 1 content"
						    });
						tc.addChild(cp2);
						
						var left = dojo.byId("dijit_layout__ScrollingTabControllerButton_1-leftBtn");
						t.assertTrue(left);
						
						var right = dojo.byId("dijit_layout__ScrollingTabControllerButton_2-rightBtn");
						t.assertTrue(right);
						
						var menu = dojo.byId("dijit_layout__ScrollingTabControllerButton_0-menuBtn");
						t.assertTrue(menu);
					}
				}
			]);
			
			doh.register( "deletingTabs", [
				{
					name: 'deleteTab',
					runTest: function(t){
						var tc2 = dijit.byId("tc2");
						var cp1 = dijit.byId("cp1");
						
						tc2.removeChild(cp1);
						
						var childPanes = tc2.getChildren();
						t.assertEqual(2, childPanes.length);
						t.assertTrue(cp1.domNode);
					}
				},
				{
					name: 'deletedTabLabel',
					runTest: function(t){
						var label = dojo.byId("#tc2 #tc2_tablist_cp1");
						
						t.assertFalse(label);
					}
				},
				{
					name: 'removedOverflowMenu',
					runTest: function(t){
						var tc = dijit.byId("tc1");
						
						var cp = dijit.byId('t3');
						tc.removeChild(cp);
						
						var left = dojo.byId("dijit_layout__ScrollingTabControllerButton_1-leftBtn");
						t.assertEqual("none", dojo.style(left, "display"));
						
						var right = dojo.byId("dijit_layout__ScrollingTabControllerButton_2-rightBtn");
						t.assertEqual("none", dojo.style(right, "display"));
						
						var menu = dojo.byId("dijit_layout__ScrollingTabControllerButton_0-menuBtn");
						t.assertEqual("none", dojo.style(menu, "display"));
					}
				}
			]);
			
			doh.register( "selectingTabs", [
				{
					name: 'focused',
					runTest: function(t){
						var tc = dijit.byId("tc2");
						var cp = dijit.byId('cp2');
						t.assertEqual(dojo.global.dijit._curFocus, dojo.byId("tc2_tablist_cp2"));
					}
				}
			]);
			doh.register( "closableTabs", [
				{
					name: "closeTab",
					runTest: function(t){
						var cp = dijit.byId("cp6");
						var cp2 = dijit.byId("cp5");
						
						t.assertTrue(cp.controlButton.closeButton);
						t.assertFalse(cp2.controlButton.closeButton);
					}
				}
			]);
			doh.register( "icon", [
				{
					name: "initialIcon",
					runTest: function(t){
						var cp =  dijit.byId("cp4");
						t.assertEqual('plusIcon', cp.controlButton.iconClass);
					}
				},
				{
					name: "changeIcon",
					runTest: function(t){
						var cp =  dijit.byId("cp4");
						cp.attr("iconClass", "noteIcon") 
						t.assertEqual('noteIcon', cp.controlButton.iconClass);
					}
				},
				{
					name: "noTitle",
					runTest: function(t){
						var cp =  dijit.byId("cp7");
						t.assertFalse(cp.controlButton.showLabel);
					}
				}
			]);
			/*
			doh.register( "changeTabName", [
				{
					name: 'changeName',
					runTest: function(t){
						var cp = dijit.byId('cp1');
						cp.attr('title', 'newTitle');
						
						var tc = dijit.byId("tc2");
						tc.selectChild(cp);
						console.log(tc.showTitle);
					}
				}
			]);			
			*/
			doh.register( "layoutTests", [
				{
					name: "topLeftRightBottom",
					runTest: function(t){
						var tc = dijit.byId("tc1");
						
						t.assertEqual('top', tc.tabPosition);
						
						tc.attr("tabPosition", "left");						
						t.assertEqual('left', tc.tabPosition);
						
						tc.attr("tabPosition", "right");						
						t.assertEqual('right', tc.tabPosition);
						
						tc.attr("tabPosition", "bottom");						
						t.assertEqual('bottom', tc.tabPosition);
						console.debug(tc);
					}
				},
				{
					name: "nested",
					runTest: function(t){
						var tc = dijit.byId("tcNested");
						
						t.assertFalse(tc.nested);
						
						var children = tc.getChildren();
						t.assertEqual(2, children.length);
						
						t.assertTrue(children[1].nested);
					}
				},
				{
					name: "doLayoutFalse",
					runTest: function(t){
						var tc = dijit.byId("tcDoLayout");
						var cps = tc.getChildren();
						
						tc.selectChild(cps[1]);
						var height1 = cps[0]._contentBox.h;
						var height2 = cps[1]._contentBox.h;
						
						t.assertTrue(height1 < height2);
					}
				},
				{
					name: "doLayoutTure",
					runTest: function(t){
						var tc = dijit.byId("tc3");
						var cps = tc.getChildren();
						
						tc.selectChild(cps[1]);
						var height1 = cps[0]._contentBox.h;
						var height2 = cps[1]._contentBox.h;
						
						t.assertTrue(height1 === height2);
					}
				}
				
			]);
			
			doh.run();

		});
	</script>

</head>
<body class="tundra">

	<h1 class="testTitle">Dijit layout.TabContainer tests</h1>
	
	<div dojoType="dijit.layout.TabContainer" style="width: 30%; height: 100px;" id="tc1">
	  <div dojoType="dijit.layout.ContentPane" title="tab1" selected="true">
	    Lorem ipsum and all around...
	  </div>
	  <div dojoType="dijit.layout.ContentPane" title="tab2">
	    Lorem ipsum and all around - second...
	  </div>
	  <div dojoType="dijit.layout.ContentPane" id="t3" title="tab3" closable="true">
	    Lorem ipsum and all around - last...
	  </div>
	</div>
	
	<div dojoType="dijit.layout.TabContainer" style="width: 30%; height: 100px;" id="tc2">
	  <div dojoType="dijit.layout.ContentPane" id="cp1" title="tab1" selected="true">
	    Lorem ipsum and all around...
	  </div>
	  <div dojoType="dijit.layout.ContentPane" id="cp2" title="tab2">
	    Lorem ipsum and all around - second...
	  </div>
	  <div dojoType="dijit.layout.ContentPane" id="cp3" title="tab3" closable="true">
	    Lorem ipsum and all around - last...
	  </div>
	</div>
	
	<div dojoType="dijit.layout.TabContainer" style="width: 30%; height: 100px;" id="tc3">
	  <div dojoType="dijit.layout.ContentPane" id="cp4" title="tab1" selected="true" iconClass="plusIcon">
	    Lorem ipsum and all around...
	  </div>
	  <div dojoType="dijit.layout.ContentPane" id="cp5" title="tab2">
	    	 Lorem ipsum and all around - last...
	            <br />
	            <br />
	            <br />
	            Hmmm even more expanding tabs......
	  </div>
	  <div dojoType="dijit.layout.ContentPane" id="cp6" title="tab3" closable="true">
	    Lorem ipsum and all around - last...
	  </div>
	<div dojoType="dijit.layout.ContentPane" id="cp7" title="tab3" closable="true" iconClass="plusIcon" showTitle="false">
	    Lorem ipsum and all around - last...
	  </div>
	</div>
	
	<div dojoType="dijit.layout.TabContainer" style="width: 400px; height: 100px;" id="tcNested">
	    <div dojoType="dijit.layout.TabContainer" title="Tab 1" nested="true">
	        <div dojoType="dijit.layout.ContentPane" title="My first inner tab" selected="true">
	            Lorem ipsum and all around...
	        </div>
	        <div dojoType="dijit.layout.ContentPane" title="My second inner tab">
	            Lorem ipsum and all around - second...
	        </div>
	        <div dojoType="dijit.layout.ContentPane" title="My last inner tab">
	            Lorem ipsum and all around - last...
	        </div>
	    </div>
	    <div dojoType="dijit.layout.TabContainer" title="Tab 2" nested="true">
	        <div dojoType="dijit.layout.ContentPane" title="My first inner tab" selected="true">
	            Lorem ipsum and all around...
	        </div>
	        <div dojoType="dijit.layout.ContentPane" title="My second inner tab">
	            Lorem ipsum and all around - second...
	        </div>
	        <div dojoType="dijit.layout.ContentPane" title="My last inner tab">
	            Lorem ipsum and all around - last...
	        </div>
	    </div>
	</div>
	
	<div dojoType="dijit.layout.TabContainer" id="tcDoLayout" style="width: 100%;" doLayout="false">
	        <div dojoType="dijit.layout.ContentPane" title="My first tab" selected="true">
	            Lorem ipsum and all around...
	        </div>
	        <div dojoType="dijit.layout.ContentPane" title="My second tab" closable="true">
	            Lorem ipsum and all around - second...
	            <br />
	            Hmmm expanding tabs......
	        </div>
	        <div dojoType="dijit.layout.ContentPane" title="My last tab">
	            Lorem ipsum and all around - last...
	            <br />
	            <br />
	            <br />
	            Hmmm even more expanding tabs......
	        </div>
	    </div>
	</body>
</html>
